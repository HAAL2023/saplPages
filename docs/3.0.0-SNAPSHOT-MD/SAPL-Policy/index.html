

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/assets/css/just-the-docs-default.css">

  <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet">

  <style id="jtd-nav-activation">
  

.site-nav > ul.nav-list:first-child > li > a,
.site-nav > ul.nav-list:first-child > li > ul > li > a,
.site-nav > ul.nav-list:first-child > li > ul > li > ul > li:not(:nth-child(4)) > a {
  background-image: none;
}

.site-nav > ul.nav-list:not(:first-child) a,
.site-nav li.external a {
  background-image: none;
}

.site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(5) > ul > li:nth-child(4) > a {
  font-weight: 600;
  text-decoration: none;
}.site-nav > ul.nav-list:first-child > li:nth-child(1) > button svg,
.site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(5) > button svg {
  transform: rotate(-90deg);
}.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list,
.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list > li.nav-list-item:nth-child(5) > ul.nav-list {
  display: block;
}
  </style>

  

  
    <script src="/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="icon" href="/assets/sapl_reference_images/favicon.png" type="image/x-icon">



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>SAPL Policy | SAPL</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="SAPL Policy" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="SAPL is a powerful policy language and engine to implement Attribute-based access control (ABAC). It comes with developement tools for testing, authorization servers, authoring tools. Framework integrations are available for Spring, Axon, and Vaadin to provide flexible policy enforcement points (PEPs) in your application." />
<meta property="og:description" content="SAPL is a powerful policy language and engine to implement Attribute-based access control (ABAC). It comes with developement tools for testing, authorization servers, authoring tools. Framework integrations are available for Spring, Axon, and Vaadin to provide flexible policy enforcement points (PEPs) in your application." />
<link rel="canonical" href="https://heutelbeck.github.io/SAPL-Policy/" />
<meta property="og:url" content="https://heutelbeck.github.io/SAPL-Policy/" />
<meta property="og:site_name" content="SAPL" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="SAPL Policy" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"SAPL is a powerful policy language and engine to implement Attribute-based access control (ABAC). It comes with developement tools for testing, authorization servers, authoring tools. Framework integrations are available for Spring, Axon, and Vaadin to provide flexible policy enforcement points (PEPs) in your application.","headline":"SAPL Policy","url":"https://heutelbeck.github.io/SAPL-Policy/"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="icon" href="/assets/sapl_reference_images/favicon.png" type="image/png">
<!-- Matomo -->
<script type="text/javascript">
    var _paq = window._paq || [];    
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
        var u="//www.ftk.de/statistik/";
        _paq.push(['setTrackerUrl', u+'matomo.php']);
        _paq.push(['setSiteId', '2']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
    })();
</script>
<!-- End Matomo Code -->


</head>

<body>
  <a class="skip-to-main" href="#main-content">Skip to main content</a>
  <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="svg-link" viewBox="0 0 24 24">
  <title>Link</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
  </svg>
</symbol>

  <symbol id="svg-menu" viewBox="0 0 24 24">
  <title>Menu</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</symbol>

  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
  <title>Expand</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
    <polyline points="9 18 15 12 9 6"></polyline>
  </svg>
</symbol>

  <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>

  
    <symbol id="svg-doc" viewBox="0 0 24 24">
  <title>Document</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
  </svg>
</symbol>

    <symbol id="svg-search" viewBox="0 0 24 24">
  <title>Search</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
  </svg>
</symbol>

  
  
    <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md -->
<symbol id="svg-copy" viewBox="0 0 16 16">
  <title>Copy</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
  </svg>
</symbol>
<symbol id="svg-copied" viewBox="0 0 16 16">
  <title>Copied</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16">
    <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/>
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/>
  </svg>
</symbol>

  
</svg>

  <div class="side-bar">
  <div class="site-header" role="banner">
    <a href="https://sapl.io/" class="site-title lh-tight">
  return to SAPL.io

</a>
    <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg>
    </button>
  </div>

  <nav aria-label="Main" id="site-nav" class="site-nav">
  
  
    <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in SAPL Reference category" aria-pressed="false">
      <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
    </button><a href="/" class="nav-list-link">SAPL Reference</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Introduction category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/docs/3.0.0-SNAPSHOT-MD/Introduction/" class="nav-list-link">Introduction</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/docs/3.0.0-SNAPSHOT-MD/Authorization-Subscriptions/" class="nav-list-link">Authorization Subscriptions</a>
              </li><li class="nav-list-item">
                <a href="/docs/3.0.0-SNAPSHOT-MD/Structure-of-a-SAPL-Policy/" class="nav-list-link">Structure of a SAPL Policy</a>
              </li><li class="nav-list-item">
                <a href="/docs/3.0.0-SNAPSHOT-MD/Authorization-Decisions/" class="nav-list-link">Authorization Decisions</a>
              </li><li class="nav-list-item">
                <a href="/docs/3.0.0-SNAPSHOT-MD/Accessing-Attributes/" class="nav-list-link">Accessing Attributes</a>
              </li><li class="nav-list-item">
                <a href="/docs/3.0.0-SNAPSHOT-MD/Getting-Started/" class="nav-list-link">Getting Started</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Reference Architecture category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/Reference-Architecture" class="nav-list-link">Reference Architecture</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/pep/" class="nav-list-link">PEP</a>
              </li><li class="nav-list-item">
                <a href="/pdp/" class="nav-list-link">PDP</a>
              </li><li class="nav-list-item">
                <a href="/pap/" class="nav-list-link">PAP</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Publish/Subscribe Protocol category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/Publish-Subscribe-Protocol/" class="nav-list-link">Publish/Subscribe Protocol</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/SAPL-Authorization-Subscription/" class="nav-list-link">SAPL Authorization Subscription</a>
              </li><li class="nav-list-item">
                <a href="/SAPL-Authorization-Decision/" class="nav-list-link">SAPL Authorization Decision</a>
              </li><li class="nav-list-item">
                <a href="/Policy-Evaluation/" class="nav-list-link">Policy Evaluation</a>
              </li><li class="nav-list-item">
                <a href="/Multi-Subscriptions/" class="nav-list-link">Multi Subscriptions</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in PDP APIs category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/PDP-APIs/" class="nav-list-link">PDP APIs</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/HTTP-Server-Sent-Events-API/" class="nav-list-link">HTTP Server-Sent Events API</a>
              </li><li class="nav-list-item">
                <a href="/Java-API/" class="nav-list-link">Java API</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in The SAPL Policy Language category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/The-SAPL-Policy-Language/" class="nav-list-link">The SAPL Policy Language</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/Overview/" class="nav-list-link">Overview</a>
              </li><li class="nav-list-item">
                <a href="/Imports/" class="nav-list-link">Imports</a>
              </li><li class="nav-list-item">
                <a href="/Schemas/" class="nav-list-link">Schemas</a>
              </li><li class="nav-list-item">
                <a href="/SAPL-Policy/" class="nav-list-link">SAPL Policy</a>
              </li><li class="nav-list-item">
                <a href="/SAPL-Policy-Set/" class="nav-list-link">SAPL Policy Set</a>
              </li><li class="nav-list-item">
                <a href="/Language-Elements/" class="nav-list-link">Language Elements</a>
              </li><li class="nav-list-item">
                <a href="/SAPL-Expressions/" class="nav-list-link">SAPL Expressions</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Authorization Subscription Evaluation category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/docs/6_1_AuthorizationSubscriptionEvaluation/" class="nav-list-link">Authorization Subscription Evaluation</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/Policy/" class="nav-list-link">Policy</a>
              </li><li class="nav-list-item">
                <a href="/Policy-Set/" class="nav-list-link">Policy Set</a>
              </li><li class="nav-list-item">
                <a href="/Authorization-Subscription/" class="nav-list-link">Authorization Subscription</a>
              </li><li class="nav-list-item">
                <a href="/Combining-Algorithm/" class="nav-list-link">Combining Algorithm</a>
              </li><li class="nav-list-item">
                <a href="/Transformation/" class="nav-list-link">Transformation</a>
              </li><li class="nav-list-item">
                <a href="/Obligation-Advice/" class="nav-list-link">Obligation / Advice</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Functions category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/Functions/" class="nav-list-link">Functions</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/Custom-Function-Libraries/" class="nav-list-link">Custom Function Libraries</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Attribute Finders category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/Attribute-Finders/" class="nav-list-link">Attribute Finders</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/Custom-Attribute-Finders/" class="nav-list-link">Custom Attribute Finders</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Testing SAPL policies category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/Testing-SAPL-policies/" class="nav-list-link">Testing SAPL policies</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/Usage-scenarios/" class="nav-list-link">Usage scenarios</a>
              </li><li class="nav-list-item">
                <a href="/Embedded-PDP/" class="nav-list-link">Embedded PDP</a>
              </li><li class="nav-list-item">
                <a href="/SAPL-Server/" class="nav-list-link">SAPL Server</a>
              </li><li class="nav-list-item">
                <a href="/Unit-Tests/" class="nav-list-link">Unit-Tests</a>
              </li><li class="nav-list-item">
                <a href="/Policy-Integration-Tests/" class="nav-list-link">Policy-Integration-Tests</a>
              </li><li class="nav-list-item">
                <a href="/Writing-test-cases/" class="nav-list-link">Writing test cases</a>
              </li><li class="nav-list-item">
                <a href="/Code-Coverage-Reports-via-the-SAPL-Maven-Plugin/" class="nav-list-link">Code Coverage Reports via the SAPL Maven Plugin</a>
              </li></ul></li></ul></li></ul>

  <ul class="nav-list"><li class="nav-list-item external">
          <a href="https://github.com/heutelbeck/sapl-policy-engine" class="nav-list-link external"
            
          >
            SAPL on GitHub
            <svg viewBox="0 0 24 24" aria-labelledby="svg-external-link-title"><use xlink:href="#svg-external-link"></use></svg>
          </a>
        </li></ul>
</nav>


  
  
    <br>

  
</div>

  <div class="main" id="top">
    <div id="main-header" class="main-header">
  
    

<div class="search" role="search">
  <div class="search-input-wrap">
    <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search SAPL" aria-label="Search SAPL" autocomplete="off">
    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
  </div>
  <div id="search-results" class="search-results"></div>
</div>

  
  
  
    <nav aria-label="Auxiliary" class="aux-nav">
  <ul class="aux-nav-list">
    
      <li class="aux-nav-list-item">
        <a href="https://github.com/heutelbeck/sapl-policy-engine" class="site-button"
          
        >
          SAPL on GitHub
        </a>
      </li>
    
  </ul>
</nav>

  
</div>

    <div class="main-content-wrap">
      <nav aria-label="Breadcrumb" class="breadcrumb-nav">
  <ol class="breadcrumb-nav-list">
  
    <li class="breadcrumb-nav-list-item"><a href="/">SAPL Reference</a></li>
    <li class="breadcrumb-nav-list-item"><a href="/The-SAPL-Policy-Language/">The SAPL Policy Language</a></li>
  <li class="breadcrumb-nav-list-item"><span>SAPL Policy</span></li>
  </ol>
</nav>
      <div id="main-content" class="main-content">
        <main>
          
            <h3 id="sapl-policy">
  
  
    <a href="#sapl-policy" class="anchor-heading" aria-labelledby="sapl-policy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SAPL Policy
  
  
</h3>
    

<p>This section describes the elements of a SAPL policy in more detail. A policy contains an entitlement (<code class="language-plaintext highlighter-rouge">permit</code> or <code class="language-plaintext highlighter-rouge">deny</code>) and can be evaluated against an authorization subscription. If the conditions in the target expression and in the body are fulfilled, the policy evaluates to its entitlement. Otherwise, it evaluates to <code class="language-plaintext highlighter-rouge">NOT_APPLICABLE</code> (if one of the conditions is not satisfied) or <code class="language-plaintext highlighter-rouge">INDETERMINATE</code> (if an error occurred).</p>

<p>A SAPL policy starts with the keyword <code class="language-plaintext highlighter-rouge">policy</code>.</p>
<h4 id="name">
  
  
    <a href="#name" class="anchor-heading" aria-labelledby="name"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Name
  
  
</h4>
    

<p>The keyword <code class="language-plaintext highlighter-rouge">policy</code> is followed by the policy name. The name is a string <em>identifying</em> the policy. Therefore, it must be unique. Accordingly, in systems with many policy sets and policies, it is recommended to use a schema to create names (e.g., <code class="language-plaintext highlighter-rouge">"policy:patientdata:permit-doctors-read"</code>).</p>
<h4 id="entitlement">
  
  
    <a href="#entitlement" class="anchor-heading" aria-labelledby="entitlement"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Entitlement
  
  
</h4>
    

<p>SAPL expects an entitlement specification. This can either be <code class="language-plaintext highlighter-rouge">permit</code> or <code class="language-plaintext highlighter-rouge">deny</code>. The entitlement is the value to which the policy evaluates if the policy is applicable to the authorization subscription, i.e., if both the conditions in the policy’s target expression and in the policy’s body are satisfied.</p>

<blockquote class="note">
  <p>Since multiple policies can be applicable and the combining algorithm can be chosen, it might make a difference whether there is an explicit <code class="language-plaintext highlighter-rouge">deny</code>-policy or whether there is just no permitting policy for a certain situation.</p>
</blockquote>
<h4 id="target-expression">
  
  
    <a href="#target-expression" class="anchor-heading" aria-labelledby="target-expression"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Target Expression
  
  
</h4>
    

<p>After the entitlement, an <strong>optional</strong> target expression can be specified. This is a condition for applying the policy, hence an expression that must evaluate to either <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code>. Which elements are allowed in SAPL expressions is described <a href="#expressions">below</a>.</p>

<p>If the target expression evaluates to <code class="language-plaintext highlighter-rouge">true</code> for a certain authorization subscription, the policy <em>matches</em> this subscription. A missing target expression makes the policy match any subscription.</p>

<p>A matching policy whose conditions in the body evaluate to <code class="language-plaintext highlighter-rouge">true</code> is called <em>applicable</em> to an authorization subscription and returns its entitlement. Both target expression and body define conditions that must be satisfied for the policy to be applicable. Although they seem to serve a similar purpose, there is an important difference: For an authorization subscription, the target expression of each top-level document is checked to select policies matching the subscription from a possibly large set of policy documents. Indexing mechanisms may be used to fulfill this task efficiently.</p>

<p>Accordingly, there are two limitations regarding the elements allowed in the target:</p>

<ul>
  <li>As lazy evaluation deviates from Boolean logic and prevents effective indexing, the logical operators <code class="language-plaintext highlighter-rouge">&amp;&amp;</code> and <code class="language-plaintext highlighter-rouge">||</code> may not be used. Instead, the target needs to use the operators <code class="language-plaintext highlighter-rouge">&amp;</code> and <code class="language-plaintext highlighter-rouge">|</code>, for which eager evaluation is applied.</li>
  <li><a href="#attribute-finders">Attribute finder steps</a> that have access to environment variables and may contact external PIPs are not allowed in the target. Functions may be used because their output only depends on the arguments passed.</li>
</ul>
<h4 id="body">
  
  
    <a href="#body" class="anchor-heading" aria-labelledby="body"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Body
  
  
</h4>
    

<p>The policy body is <strong>optional</strong> and starts with the keyword <code class="language-plaintext highlighter-rouge">where</code>. It contains one or more statements, each of which must evaluate to <code class="language-plaintext highlighter-rouge">true</code> for the policy to apply to a certain authorization subscription. Accordingly, the body extends the condition in the target expression and further limits the policy’s applicability.</p>

<p>A statement within the body can either be a variable assignment which makes a variable available under a certain name (and always evaluates to <code class="language-plaintext highlighter-rouge">true</code>)</p>

<p>Sample Variable Assignment</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="kt">var</span> <span class="n">a_name</span> <span class="o">=</span> <span class="n">expression</span><span class="o">;</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>or a condition, i.e., an expression that evaluates to <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code>.</p>

<p>Sample Condition</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">a_name</span> <span class="o">==</span> <span class="s">"a_string"</span><span class="o">;</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>Each statement is concluded with a semicolon <code class="language-plaintext highlighter-rouge">;</code>.</p>

<p>There are no restrictions on the syntax elements allowed in the policy body. Lazy evaluation is used for the conjunction of the statements - i.e., if one statement evaluates to <code class="language-plaintext highlighter-rouge">false</code>, the policy returns the decision <code class="language-plaintext highlighter-rouge">NOT_APPLICABLE</code>, even if future statements would cause an error.</p>

<p>If the body is missing (or does not contain any condition statement), the policy is applicable to any authorization subscription which the policy matches (i.e., for which the target expression evaluates to <code class="language-plaintext highlighter-rouge">true</code>).</p>
<h5 id="variable-assignment">
  
  
    <a href="#variable-assignment" class="anchor-heading" aria-labelledby="variable-assignment"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Variable Assignment
  
  
</h5>
    

<p>A variable assignment starts with the keyword <code class="language-plaintext highlighter-rouge">var</code>, followed by an identifier under which the assigned value should be available, followed by <code class="language-plaintext highlighter-rouge">=</code> and an expression. The assignment can be followed by the optional keyword <code class="language-plaintext highlighter-rouge">schema</code> and one or more schema expressions separated by <code class="language-plaintext highlighter-rouge">,</code>. The schema expression(s) must evaluate to a valid JSON schema.</p>

<p>After a variable assignment, the result of evaluating the expression can be used in later conditions within the same policy under the specified name. This is useful because it allows to execute time-consuming calculations or requests to external attribute stores only once, and the result can be used in multiple expressions. Additionally, it can make policies shorter and improve readability.</p>

<p>The expression can use any element of the SAPL expression language, especially of attribute finder steps that are not allowed in the target expression.</p>

<p>The value assignment statement always evaluates to <code class="language-plaintext highlighter-rouge">true</code>.</p>
<h5 id="condition">
  
  
    <a href="#condition" class="anchor-heading" aria-labelledby="condition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Condition
  
  
</h5>
    

<p>A condition statement simply consists of an expression that must evaluate to <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code>.</p>

<p>The expression can use any element of the SAPL expression language, especially of attribute finder steps that are not allowed in the target expression. Conditions in the policy body are used to further limit the applicability of a policy.</p>
<h4 id="obligation">
  
  
    <a href="#obligation" class="anchor-heading" aria-labelledby="obligation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Obligation
  
  
</h4>
    

<p>An <strong>optional</strong> obligation expression contains a task which the PEP must fulfill before granting or denying access. It consists of the keyword <code class="language-plaintext highlighter-rouge">obligation</code> followed by an expression.</p>

<p>A common situation in which obligations are useful is <em>Break the Glass Scenarios</em>. Assuming in case of an emergency, a doctor should also have access to medical records that she normally cannot read. However, this emergency access must be logged to prevent abuse. In this situation, logging is a requirement for granting access and therefore must be commanded in an obligation.</p>

<p>Obligations are only returned in the authorization decision if the decision is <code class="language-plaintext highlighter-rouge">PERMIT</code> or <code class="language-plaintext highlighter-rouge">DENY</code>. The PDP simply collects all obligations from policies evaluating to one of these entitlements. Depending on the final decision, the obligations and advice which belong to this decision are included in the authorization decision object. It does not matter if the obligation is described with a string (like <code class="language-plaintext highlighter-rouge">"create_emergency_access_log"</code>) or an object (like <code class="language-plaintext highlighter-rouge">{ "task" : "create_log", "content" : "emergency_access" }</code>) or another JSON value - only the PEP must be implemented in a way that it knows how to process these obligations.</p>

<p>In any policy an arbitrary number of obligation expressions, all introduced with the <strong>obligation</strong> keyword may be present. All obligation expressions must be written down before any <strong>advice</strong>.</p>
<h4 id="advice">
  
  
    <a href="#advice" class="anchor-heading" aria-labelledby="advice"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Advice
  
  
</h4>
    

<p>An <strong>optional</strong> advice expression is treated similarly to an obligation expression. Unlike obligations, fulfilling the described tasks in the advice is not a requirement for granting or denying access. The advice expression consists of the keyword <code class="language-plaintext highlighter-rouge">advice</code> followed by any expression.</p>

<p>If the final decision is <code class="language-plaintext highlighter-rouge">PERMIT</code> or <code class="language-plaintext highlighter-rouge">DENY</code>, advice from all policies evaluating to this decision is included in the authorization decision object by the PDP.</p>

<p>In any policy an arbitrary number of advice expressions, all introduced with the <strong>advice</strong> keyword may be present. All advice expressions must be written down after any <strong>obligation</strong>.</p>
<h4 id="transformation">
  
  
    <a href="#transformation" class="anchor-heading" aria-labelledby="transformation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Transformation
  
  
</h4>
    

<p>An <strong>optional</strong> transformation statement starts with the keyword <code class="language-plaintext highlighter-rouge">transform</code> and followed by an expression. If a transformation statement is supplied and the policy evaluates to <code class="language-plaintext highlighter-rouge">permit</code>, the result of evaluating the expression will be returned as the <code class="language-plaintext highlighter-rouge">resource</code> in the authorization decision object.</p>

<p>Accordingly, a transformation statement might be used to hide certain information (e.g., <em>a doctor can access patient data but should not see bank account details</em>). This can be reached by applying a filter to the original resource, which removes or blackens certain attributes. Thus, SAPL allows for <strong>fine-grained</strong> or <strong>field-level</strong> access control without the need to treat each attribute as a resource and write a specific policy for it.</p>

<p>The original resource is accessible via the identifier <code class="language-plaintext highlighter-rouge">resource</code> and can be filtered as follows:</p>

<p>Transformation Example</p>

<div class="table-wrapper"><table>
  <tbody>
    <tr>
      <td>transform resource</td>
      <td>- { @.someValue : remove, @.anotherValue : filter.blacken }</td>
    </tr>
  </tbody>
</table></div>

<p>The example would remove the attribute <code class="language-plaintext highlighter-rouge">someValue</code> and blacken the value of the attribute <code class="language-plaintext highlighter-rouge">anotherValue</code>. The filtering functions are described in more detail <a href="#filtering">below</a>.</p>

<p>It is not possible to combine multiple transformation statements through multiple policies. Each combining algorithm in SAPL will not return the decision <code class="language-plaintext highlighter-rouge">PERMIT</code> if there is more than one policy evaluating to <code class="language-plaintext highlighter-rouge">PERMIT</code>, and at least one of them contains a transformation statement (this is called <em>transformation uncertainty</em>). For more details, <a href="#combining-algorithms">see below</a>.</p>

<p>Transformation statements can be interpreted as a special case of obligation, requiring the PEP to replace the resource accordingly.</p>


          

          
        </main>
        

  <hr>
  <footer>
    
      <p><a href="#top" id="back-to-top">Back to top</a></p>
    

    <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2024 Dominic Heutelbeck. Distributed by an <a href="https://github.com/heutelbeck/sapl-policy-engine/blob/master/LICENSE.md">License.</a></p>

    
      <div class="d-flex mt-2">
        
        
      </div>
    
  </footer>


      </div>
    </div>
    
      

<div class="search-overlay"></div>

    
  </div>

  
    






  <script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script>


<script>
  var config = {}
;
  mermaid.initialize(config);
  window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
</script>



  
</body>
</html>

